<nav class="sidebar" id="sidebar" th:fragment="sidebar">
    <header>
        <div class="image-text">
            <span class="image">
                <!-- Ícone do Logo -->
                <i class="bi bi-kanban display-6"></i>
            </span>

            <div class="text logo-text">
                <span class="name">TaskFlow</span>
                <span class="profession">Gerenciador</span>
            </div>
        </div>

        <i class="bi bi-chevron-right toggle"></i>
    </header>

    <div class="menu-bar">
        <div class="menu">

            <li class="search-box">
                <i class="bi bi-search icon"></i>
                <input type="text" placeholder="Buscar...">
            </li>

            <ul class="menu-links">
                <!-- Dashboard -->
                <li class="nav-link" th:classappend="${activePage == 'dashboard'} ? 'active'">
                    <a th:href="@{/}">
                        <i class="bi bi-speedometer2 icon"></i>
                        <span class="text nav-text">Dashboard</span>
                    </a>
                </li>

                <!-- Tarefas -->
                <li class="nav-link" th:classappend="${activePage == 'tasks'} ? 'active'">
                    <a th:href="@{/tasks}">
                        <i class="bi bi-list-task icon"></i>
                        <span class="text nav-text">Tarefas</span>
                    </a>
                </li>

                <!-- Nova Tarefa -->
                <li class="nav-link" th:classappend="${activePage == 'newTask'} ? 'active'">
                    <a th:href="@{/tasks/new}">
                        <i class="bi bi-plus-circle icon"></i>
                        <span class="text nav-text">Nova Tarefa</span>
                    </a>
                </li>

                <!-- Perfil -->
                <li class="nav-link" th:classappend="${activePage == 'profile'} ? 'active'">
                    <a th:href="@{/profile}">
                        <i class="bi bi-person-circle icon"></i>
                        <span class="text nav-text">Perfil</span>
                    </a>
                </li>

                <!-- Notificações -->
                <li class="nav-link" th:classappend="${activePage == 'notifications'} ? 'active'">
                    <a th:href="@{/notifications}" class="d-flex align-items-center">
                        <i class="bi bi-bell icon"></i>
                        <span class="text nav-text">Notificações</span>
                    </a>
                </li>

                <!-- Squads (LEAD/ADMIN only) -->
                <li class="nav-link" 
                    th:if="${#authorization.expression('hasAnyRole(''LEAD'', ''ADMIN'')')}"
                    th:classappend="${activePage == 'squads'} ? 'active'">
                    <a th:href="@{/squads}">
                        <i class="bi bi-people icon"></i>
                        <span class="text nav-text">Gerenciar Squads</span>
                    </a>
                </li>
                
                <!-- My Squads (for all authenticated users) -->
                <li class="nav-link" 
                    th:classappend="${activePage == 'my-squads'} ? 'active'">
                    <a th:href="@{/squads/my}">
                        <i class="bi bi-person-badge icon"></i>
                        <span class="text nav-text">Minhas Squads</span>
                    </a>
                </li>

                <!-- Squad Invites -->
                <li class="nav-link" th:classappend="${activePage == 'invites'} ? 'active'">
                    <a th:href="@{/squads/invites}" class="d-flex align-items-center">
                        <i class="bi bi-envelope icon"></i>
                        <span class="text nav-text">Convites</span>
                        <span id="squad-invites-badge" class="badge bg-danger ms-2 d-none">0</span>
                    </a>
                </li>

                <!-- Ranking -->
                <li class="nav-link" th:classappend="${activePage == 'ranking'} ? 'active'">
                    <a th:href="@{/ranking}">
                        <i class="bi bi-trophy icon"></i>
                        <span class="text nav-text">Ranking</span>
                    </a>
                </li>

                <!-- Cancellation Requests (LEAD/ADMIN only) -->
                <li class="nav-link"
                    th:if="${#authorization.expression('hasAnyRole(''LEAD'', ''ADMIN'')')}"
                    th:classappend="${activePage == 'cancelRequests'} ? 'active'">
                    <a th:href="@{/cancel-requests}" class="d-flex align-items-center">
                        <i class="bi bi-exclamation-triangle icon"></i>
                        <span class="text nav-text">Pedidos</span>
                        <span id="cancel-requests-badge" class="badge bg-warning ms-2 d-none">0</span>
                    </a>
                </li>
            </ul>
        </div>

        <div class="bottom-content">
            <!-- Logout -->
            <li class="">
                <form method="post" th:action="@{/logout}" id="logoutForm" style="width: 100%;">
                    <a href="#" onclick="document.getElementById('logoutForm').submit(); return false;">
                        <i class="bi bi-box-arrow-right icon"></i>
                        <span class="text nav-text">Logout</span>
                    </a>
                </form>
            </li>

            <!-- Dark Mode Toggle -->
            <li class="mode">
                <div class="sun-moon">
                    <i class="bi bi-moon icon moon"></i>
                    <i class="bi bi-sun icon sun"></i>
                </div>
                <span class="mode-text text">Dark mode</span>

                <div class="toggle-switch">
                    <span class="switch"></span>
                </div>
            </li>
        </div>
    </div>
</nav>