<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head('Meu Perfil - Task Management')}"></head>
<body class="dashboard-body">

    <!-- Sidebar -->
    <nav th:replace="~{fragments/sidebar :: sidebar}"></nav>

<div class="main-content" id="mainContent">
    <div class="top-bar">
        <h1 class="page-title">Meu Perfil</h1>
        <div class="user-info">
            <a class="btn btn-primary" th:href="@{/profile/edit}"><i class="bi bi-pencil"></i> Editar Perfil</a>
        </div>
    </div>

    <div class="content-wrapper profile-view-wrapper">
        <div th:replace="~{fragments/alerts :: alerts}"></div>
        
        <!-- Profile Header Card -->
        <div class="form-card profile-section-card" data-animate="fade-up"
             th:with="avatarPath=${#strings.isEmpty(user.profile.avatarUrl) ? '/images/avatar-placeholder.svg' : user.profile.avatarUrl}">
            <div class="profile-header-card">
                <div>
                    <img alt="Avatar" class="profile-avatar"
                         th:src="@{${avatarPath}}"/>
                </div>
                <div class="profile-info">
                    <div style="display:flex; align-items:center; gap:1rem; margin-bottom:0.5rem; flex-wrap:wrap;">
                        <h2 class="profile-name" th:text="${user.fullName != null ? user.fullName : user.username}">Nome</h2>
                        <span th:if="${user.profile.githubName}" class="profile-github-name"
                              th:text="'@' + ${user.profile.githubLogin}"></span>
                    </div>
                    <p class="profile-profession" th:text="${user.profile.profession}">Profissão</p>
                    
                    <!-- GitHub Stats -->
                    <div th:if="${user.profile.githubLogin}" class="github-stats">
                        <div class="github-stat">
                            <div class="github-stat-value" 
                                 th:text="${user.profile.publicRepos != null ? user.profile.publicRepos : 0}">0</div>
                            <div class="github-stat-label">Repositórios</div>
                        </div>
                        <div class="github-stat">
                            <div class="github-stat-value" 
                                 th:text="${user.profile.followers != null ? user.profile.followers : 0}">0</div>
                            <div class="github-stat-label">Seguidores</div>
                        </div>
                        <div class="github-stat">
                            <div class="github-stat-value" 
                                 th:text="${user.profile.following != null ? user.profile.following : 0}">0</div>
                            <div class="github-stat-label">Seguindo</div>
                        </div>
                        <div th:if="${user.profile.publicGists != null && user.profile.publicGists > 0}" class="github-stat">
                            <div class="github-stat-value" th:text="${user.profile.publicGists}">0</div>
                            <div class="github-stat-label">Gists</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bio and Details Grid -->
        <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap:1.5rem; margin-top:1.5rem;">
            <!-- Left Column - About -->
            <div class="form-card profile-section-card" data-animate="fade-up">
                <h3 class="profile-section-title">
                    <i class="bi bi-person-badge"></i> Sobre
                </h3>
                <p th:if="${user.profile.bio}" class="profile-bio" th:text="${user.profile.bio}">Bio</p>
                
                <div class="profile-about-section">
                    <div th:if="${user.profile.location}" class="profile-detail-row">
                        <i class="bi bi-geo-alt"></i>
                        <strong>Local:</strong> <span th:text="${user.profile.location}"></span>
                    </div>
                    <div th:if="${user.profile.githubCompany}" class="profile-detail-row">
                        <i class="bi bi-building"></i>
                        <strong>Empresa:</strong> <span th:text="${user.profile.githubCompany}"></span>
                    </div>
                    <div th:if="${user.profile.experienceLevel}" class="profile-detail-row">
                        <i class="bi bi-bar-chart"></i>
                        <strong>Nível:</strong> <span th:text="${user.profile.experienceLevel}"></span>
                    </div>
                    <div th:if="${user.profile.primaryStack}" class="profile-detail-row">
                        <i class="bi bi-stack"></i>
                        <strong>Stack Principal:</strong> <span th:text="${user.profile.primaryStack}"></span>
                    </div>
                    <div th:if="${user.profile.availability}" class="profile-detail-row">
                        <i class="bi bi-clock"></i>
                        <strong>Disponibilidade:</strong> <span th:text="${user.profile.availability}"></span>
                    </div>
                    <div th:if="${user.profile.hireable != null && user.profile.hireable}" style="margin-top:0.5rem;">
                        <span class="hireable-badge">
                            <i class="bi bi-briefcase-fill"></i> Disponível para contratação
                        </span>
                    </div>
                </div>
            </div>

            <!-- Right Column - Links -->
            <div class="form-card profile-section-card" data-animate="fade-up">
                <h3 class="profile-section-title">
                    <i class="bi bi-link-45deg"></i> Links
                </h3>
                <div style="display:flex; flex-direction:column; gap:0.85rem;">
                    <a th:if="${user.profile.websiteUrl}" th:href="${user.profile.websiteUrl}" 
                       target="_blank" class="link-item">
                        <i class="bi bi-globe"></i> Website
                    </a>
                    <a th:if="${user.profile.githubUrl}" th:href="${user.profile.githubUrl}" 
                       target="_blank" class="link-item">
                        <i class="bi bi-github"></i> GitHub
                    </a>
                    <a th:if="${user.profile.linkedinUrl}" th:href="${user.profile.linkedinUrl}" 
                       target="_blank" class="link-item">
                        <i class="bi bi-linkedin"></i> LinkedIn
                    </a>
                    <a th:if="${user.profile.twitterUsername}" 
                       th:href="'https://twitter.com/' + ${user.profile.twitterUsername}" 
                       target="_blank" class="link-item">
                        <i class="bi bi-twitter-x"></i> Twitter/X
                    </a>
                </div>
            </div>
        </div>

        <!-- Skills Section -->
        <div th:if="${(skills != null && !skills.isEmpty()) or (softSkills != null && !softSkills.isEmpty())}" 
             class="form-card profile-section-card" data-animate="fade-up" style="margin-top:1.5rem;">
            <div class="skills-grid">
                <div th:if="${skills != null && !skills.isEmpty()}">
                    <h3 class="profile-section-title">
                        <i class="bi bi-lightning-charge-fill"></i> Hard Skills
                    </h3>
                    <div style="display:flex; gap:0.75rem; flex-wrap:wrap;">
                        <span class="skill-chip" th:each="s : ${skills}" th:text="${s}"></span>
                    </div>
                </div>
                <div th:if="${softSkills != null && !softSkills.isEmpty()}">
                    <h3 class="profile-section-title" style="margin-top:0;">
                        <i class="bi bi-people" style="color:var(--accent-color);"></i> Soft Skills
                    </h3>
                    <div style="display:flex; gap:0.75rem; flex-wrap:wrap;">
                        <span class="skill-chip soft" th:each="s : ${softSkills}" th:text="${s}"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>

<script th:src="@{/js/sidebar.js}"></script>
<script th:src="@{/js/dashboard.js}"></script>
</body>
</html>
